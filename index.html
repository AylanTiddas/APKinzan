<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Inzan n Teqbaylit - Proverbes Kabyles avec IA, Audio et Partage visuel.">
    <meta name="theme-color" content="#F9F7F3">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Inzan n Teqbaylit">
    <meta property="og:description" content="D√©couvrez la sagesse kabyle.">
    <meta property="og:type" content="website">

    <title>Inzan n Teqbaylit - Sagesse Kabyle</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tinos:ital,wght@0,400;0,700;1,400&family=Raleway:wght@300;400;500;600;700&family=Noto+Sans+Tifinagh&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22%3E%3Ctext y=%22.9em%22 font-size=%2290%22 fill=%22%234A7C59%22%3E%E2%9C%A7%3C/text%3E%3C/svg%3E">

    <style>
        :root {
            --color-bg: #F9F7F3;
            --color-bg-card: #FFFFFF;
            --color-bg-alt: #F0EFEA;
            --color-text: #3D4A3A;
            --color-text-light: #6B7280;
            --color-heading: #2F4F4F;
            --color-primary: #4A7C59;   /* Vert Kabyle */
            --color-secondary: #3A644B;
            --color-accent: #C79A2A;    /* Jaune Kabyle/Or */
            --color-accent-2: #D94F4F;  /* Rouge Tapis */
            --color-border: #E5E7EB;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.04);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.08);
            --font-serif: 'Tinos', serif;
            --font-sans: 'Raleway', sans-serif;
            --font-tifinagh: 'Noto Sans Tifinagh', sans-serif;
        }

        html.dark {
            --color-bg: #101418;
            --color-bg-card: #1A2026;
            --color-bg-alt: #1F272E;
            --color-text: #D1D5DB;
            --color-text-light: #9CA3AF;
            --color-heading: #F9FAFB;
            --color-primary: #52B788;
            --color-secondary: #3E9469;
            --color-accent: #FBBF24;
            --color-accent-2: #EF4444;
            --color-border: #374151;
        }

        body {
            background-color: var(--color-bg);
            font-family: var(--font-sans);
            color: var(--color-text);
            /* Motif subtil en fond */
            background-image: radial-gradient(var(--color-primary) 0.5px, transparent 0.5px), radial-gradient(var(--color-primary) 0.5px, var(--color-bg) 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            background-blend-mode: overlay;
            opacity: 0.99; /* Fix rendering */
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        .stagger-in { animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) both; }
        
        /* Composants */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s ease-in-out; }

        .kb-char-btn {
            font-family: var(--font-serif);
            font-weight: bold;
            transition: all 0.2s;
        }
        .kb-char-btn:active { transform: scale(0.95); }

        .loader {
            width: 20px; height: 20px;
            border: 3px solid currentColor;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: var(--color-border); border-radius: 10px; }
        
        /* Navigation active states */
        .nav-btn.active.desktop {
            color: var(--color-primary);
            border-color: var(--color-primary);
            background-color: color-mix(in srgb, var(--color-primary) 10%, transparent);
        }
        .nav-btn.active.mobile {
            color: var(--color-primary);
            background-color: var(--color-bg);
            border-radius: 50%;
            transform: translateY(-5px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        /* Styles sp√©cifiques pour le Canvas Generator */
        #canvas-preview-modal {
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8 pb-32 sm:pb-8">

    <!-- Splash Screen -->
    <div id="splash-screen" class="fixed inset-0 bg-[var(--color-bg)] z-[200] flex flex-col items-center justify-center transition-opacity duration-700 ease-out">
        <div class="animate-bounce mb-4">
            <svg width="100" height="100" viewBox="0 0 100 100" class="text-[var(--color-accent)]">
                <text x="50" y="85" font-size="90" text-anchor="middle" fill="currentColor" font-family="Noto Sans Tifinagh">‚µ£</text>
            </svg>
        </div>
        <p class="text-2xl font-serif font-bold text-[var(--color-heading)]">Inzan n Teqbaylit</p>
    </div>

    <div class="max-w-7xl mx-auto">
        
        <!-- Header -->
        <header class="relative flex flex-col items-center mb-8 md:mb-12 pt-10">
            <!-- Contr√¥les Haut Droite -->
            <div class="absolute top-0 right-0 z-50 flex items-center gap-2">
                <!-- Selecteur de Langue -->
                <button id="lang-toggle" class="flex items-center gap-1 px-3 py-1.5 rounded-full bg-[var(--color-bg-card)] shadow-md border border-[var(--color-border)] text-sm font-bold text-[var(--color-primary)] hover:bg-[var(--color-bg-alt)] transition-colors">
                    <span id="current-lang-label">FR</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                </button>

                <!-- Theme Toggle -->
                <button id="theme-toggle" class="p-2 rounded-full bg-[var(--color-bg-card)] text-[var(--color-text)] shadow-md hover:scale-110 transition-transform">
                    <svg id="theme-icon-light" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                    <svg id="theme-icon-dark" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                </button>
            </div>

            <h1 class="text-4xl md:text-6xl font-serif font-bold text-[var(--color-heading)] mb-2 text-center">
                <span class="text-[var(--color-accent)] font-tifinagh hidden sm:inline">‚µü</span>
                Inzan n Teqbaylit
                <span class="text-[var(--color-accent)] font-tifinagh hidden sm:inline">‚µ£</span>
            </h1>
            <p class="text-lg md:text-xl text-[var(--color-text-light)] font-light text-center" data-i18n="subtitle">Tr√©sors de la Sagesse Kabyle</p>
        </header>

        <!-- Desktop Nav -->
        <nav class="hidden sm:flex justify-center mb-8">
            <div class="flex items-center gap-2 p-2 bg-[var(--color-bg-card)]/90 backdrop-blur-md rounded-xl shadow-md border border-[var(--color-border)]">
                <button data-tab="accueil-tab" class="nav-btn desktop px-4 py-2 rounded-lg border-2 border-transparent font-semibold flex items-center gap-2">
                    <span data-i18n="nav_home">Accueil</span>
                </button>
                <button data-tab="explorer-tab" class="nav-btn desktop px-4 py-2 rounded-lg border-2 border-transparent font-semibold flex items-center gap-2">
                    <span data-i18n="nav_explore">Explorer</span>
                </button>
                <button data-tab="favoris-tab" class="nav-btn desktop px-4 py-2 rounded-lg border-2 border-transparent font-semibold flex items-center gap-2">
                    <span data-i18n="nav_favorites">Favoris</span>
                </button>
                <button data-tab="ai-sage-tab" class="nav-btn desktop px-4 py-2 rounded-lg border-2 border-transparent font-semibold flex items-center gap-2">
                    <span data-i18n="nav_ai">Sage AI</span>
                </button>
                <button data-tab="quiz-tab" class="nav-btn desktop px-4 py-2 rounded-lg border-2 border-transparent font-semibold flex items-center gap-2">
                    <span data-i18n="nav_quiz">Quiz</span>
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main>
            <!-- ACCUEIL -->
            <section id="accueil-tab" class="tab-content">
                <div class="max-w-4xl mx-auto mb-10 text-center p-6 bg-[var(--color-bg-card)]/70 rounded-xl shadow-inner border border-[var(--color-border)]">
                    <p class="text-lg text-[var(--color-text-light)] font-medium mb-2">
                        <span data-i18n="welcome_text">Une collection interactive de la sagesse populaire de Kabylie.</span>
                    </p>
                    <p class="text-[var(--color-primary)] font-semibold italic">"Anzi am ddwa, ilaq ad t-yesseqdec umdan akken iwulem."</p>
                </div>

                <h2 class="text-3xl font-serif text-[var(--color-primary)] mb-5 text-center font-semibold" data-i18n="proverb_of_day_title">Proverbe du Jour üí°</h2>
                <div id="proverb-of-the-day-card" class="max-w-3xl mx-auto fade-in mb-12">
                    <!-- Rempli par JS -->
                </div>
            </section>

            <!-- EXPLORER -->
            <section id="explorer-tab" class="tab-content">
                <div class="sticky top-4 z-20 bg-[var(--color-bg-card)]/90 backdrop-blur-md rounded-xl shadow-lg border border-[var(--color-border)] mb-6 overflow-hidden">
                    <div class="p-4 space-y-3">
                        
                        <!-- BARRE D'OUTILS TAMAZIGHT (NOUVEAU) -->
                        <div class="flex flex-wrap gap-1 justify-center sm:justify-start pb-2 border-b border-[var(--color-border)] bg-[var(--color-bg-alt)]/50 -mx-4 px-4 pt-2 -mt-4 mb-2">
                            <span class="text-xs text-[var(--color-text-light)] self-center mr-2 font-bold uppercase tracking-wider" data-i18n="keyboard_label">Clavier ‚µ£ :</span>
                            <div id="tamazight-keyboard" class="flex flex-wrap gap-1">
                                <!-- Boutons g√©n√©r√©s par JS -->
                            </div>
                        </div>

                        <div class="flex flex-col sm:flex-row gap-4">
                            <div class="relative flex-grow">
                                <input type="text" id="search-input" data-placeholder-i18n="search_placeholder" placeholder="Rechercher (ex: tagmatt, amour)..." class="w-full p-3 pr-10 border-2 border-[var(--color-border)] rounded-lg focus:border-[var(--color-primary)] focus:ring-2 focus:ring-[var(--color-primary)]/30 text-lg shadow-inner bg-[var(--color-bg-card)] text-[var(--color-text)]">
                                <button class="clear-search-btn absolute right-3 top-1/2 -translate-y-1/2 text-[var(--color-text-light)] opacity-0 hover:text-[var(--color-accent)] transition-opacity">‚úï</button>
                            </div>
                            <button id="random-btn" class="px-5 py-3 bg-[var(--color-accent)] text-white font-semibold rounded-lg hover:bg-[var(--color-primary)] shadow-md transition-all flex items-center justify-center gap-2">
                                <span data-i18n="btn_random">Al√©atoire</span> üé≤
                            </button>
                        </div>

                        <!-- Filtres Th√®mes -->
                        <div class="flex items-center gap-3 overflow-hidden">
                            <span class="text-sm font-bold text-[var(--color-heading)] flex-shrink-0" data-i18n="themes_label">Th√®mes:</span>
                            <div id="theme-list-container" class="flex gap-2 overflow-x-auto custom-scrollbar pb-2">
                                <!-- Th√®mes JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <div id="results-feedback" class="mb-4 text-center text-[var(--color-text-light)] font-semibold min-h-[24px]"></div>
                <div id="results-container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
                
                <div id="infinite-scroll-loader" class="text-center mt-8 p-4 hidden">
                    <span class="loader text-[var(--color-primary)]"></span>
                </div>
            </section>

            <!-- FAVORIS -->
            <section id="favoris-tab" class="tab-content">
                <h2 class="text-3xl font-serif text-[var(--color-primary)] mb-5 text-center font-semibold" data-i18n="favorites_title">Mes Favoris ‚ù§Ô∏è</h2>
                <div id="favorites-container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
                <div id="no-favorites" class="text-center mt-12 hidden">
                    <p class="text-xl text-[var(--color-text-light)]" data-i18n="no_favorites">Vous n'avez pas encore de favoris.</p>
                </div>
            </section>

            <!-- SAGE AI -->
            <section id="ai-sage-tab" class="tab-content">
                <h2 class="text-3xl font-serif text-[var(--color-primary)] mb-5 text-center font-semibold" data-i18n="ai_title">Le Sage Artificiel ü§ñ</h2>
                <div class="max-w-2xl mx-auto bg-[var(--color-bg-card)] p-6 rounded-xl shadow-lg border border-[var(--color-border)]">
                    <p class="text-center text-[var(--color-text-light)] mb-4" data-i18n="ai_desc">D√©crivez une situation, le sage trouvera le proverbe parfait.</p>
                    <textarea id="ai-context-input" class="w-full p-3 border-2 border-[var(--color-border)] rounded-lg mb-4 bg-[var(--color-bg)] text-[var(--color-text)]" rows="3" data-placeholder-i18n="ai_placeholder" placeholder="Ex: Mon ami parle beaucoup mais n'agit jamais..."></textarea>
                    <button id="ai-suggest-btn" class="w-full py-3 bg-[var(--color-secondary)] text-white font-semibold rounded-lg hover:bg-[var(--color-primary)] shadow-md transition-transform active:scale-95 flex justify-center items-center gap-2">
                        <span data-i18n="btn_ask_sage">Demander conseil</span> ‚ú®
                    </button>
                    <div id="ai-result-feedback" class="mt-6 space-y-4"></div>
                </div>
            </section>

            <!-- QUIZ -->
            <section id="quiz-tab" class="tab-content">
                 <h2 class="text-3xl font-serif text-[var(--color-primary)] mb-5 text-center font-semibold" data-i18n="quiz_title">Quiz de Sagesse üß†</h2>
                 <div id="quiz-container" class="max-w-3xl mx-auto bg-[var(--color-bg-card)] p-8 rounded-xl shadow-lg border border-[var(--color-border)] min-h-[300px] flex items-center justify-center">
                     <!-- Contenu Quiz JS -->
                 </div>
            </section>
        </main>
    </div>

    <!-- Mobile Nav -->
    <nav class="sm:hidden fixed bottom-4 left-4 right-4 bg-[var(--color-bg-card)]/90 backdrop-blur-lg border border-[var(--color-border)] flex justify-around shadow-2xl z-40 rounded-2xl p-2">
        <button data-tab="accueil-tab" class="nav-btn mobile flex-1 flex flex-col items-center p-2 text-[var(--color-text)]">
            <span class="text-xl">üè†</span><span class="text-[10px] font-bold mt-1" data-i18n="nav_home">Accueil</span>
        </button>
        <button data-tab="explorer-tab" class="nav-btn mobile flex-1 flex flex-col items-center p-2 text-[var(--color-text)]">
            <span class="text-xl">üîç</span><span class="text-[10px] font-bold mt-1" data-i18n="nav_explore">Explorer</span>
        </button>
        <button data-tab="favoris-tab" class="nav-btn mobile flex-1 flex flex-col items-center p-2 text-[var(--color-text)]">
            <span class="text-xl">‚ù§Ô∏è</span><span class="text-[10px] font-bold mt-1" data-i18n="nav_favorites">Favoris</span>
        </button>
        <button data-tab="ai-sage-tab" class="nav-btn mobile flex-1 flex flex-col items-center p-2 text-[var(--color-text)]">
            <span class="text-xl">ü§ñ</span><span class="text-[10px] font-bold mt-1" data-i18n="nav_ai">Sage</span>
        </button>
    </nav>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-24 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full shadow-xl z-50 transition-all duration-300 opacity-0 translate-y-10 text-white font-medium text-sm flex items-center gap-2"></div>

    <!-- Modal Universelle -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black/60 z-[100] hidden backdrop-blur-sm transition-opacity"></div>
    <div id="modal-content" class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-2xl max-h-[85vh] bg-[var(--color-bg-card)] rounded-xl shadow-2xl z-[101] hidden flex flex-col overflow-hidden transform transition-all scale-95 opacity-0">
        <header class="p-4 border-b border-[var(--color-border)] flex justify-between items-center bg-[var(--color-bg-alt)]">
            <h3 id="modal-title" class="text-xl font-bold text-[var(--color-heading)]"></h3>
            <button id="modal-close-btn" class="p-1 rounded-full hover:bg-[var(--color-border)] transition">‚úï</button>
        </header>
        <div id="modal-body" class="p-6 overflow-y-auto text-[var(--color-text)]"></div>
    </div>

    <!-- Canvas Generator Invisible Container -->
    <div id="canvas-container" class="hidden">
        <canvas id="share-canvas"></canvas>
    </div>

<script>
/**
 * CONSTANTES & CONFIGURATION
 */
const CONFIG = {
    GEMINI_API_KEY: "", // √Ä REMPLIR PAR LE SYST√àME
    CHARS_KB: ['…õ', '…£', 'ƒç', '«ß', '·∏•', '·πõ', '·π£', '·π≠', '·∫ì', '·∏ç', ' ∑'],
    PROVERBS_PER_PAGE: 40
};

/**
 * TRADUCTIONS (I18N)
 */
const I18N = {
    fr: {
        nav_home: "Accueil", nav_explore: "Explorer", nav_favorites: "Favoris", nav_ai: "Sage AI", nav_quiz: "Quiz",
        subtitle: "Tr√©sors de la Sagesse Kabyle",
        welcome_text: "D√©couvrez et explorez des milliers de proverbes kabyles (Inzan).",
        proverb_of_day_title: "Proverbe du Jour üí°",
        keyboard_label: "CLAVIER ‚µ£ :",
        search_placeholder: "Rechercher par mot-cl√©...",
        themes_label: "Th√®mes:",
        btn_random: "Al√©atoire",
        favorites_title: "Mes Favoris ‚ù§Ô∏è",
        no_favorites: "Vous n'avez pas encore de proverbes favoris.",
        ai_title: "Le Sage Artificiel ü§ñ",
        ai_desc: "D√©crivez une situation, et laissez notre sage vous proposer les proverbes les plus pertinents.",
        ai_placeholder: "Exemple : Mon ami parle beaucoup mais n'agit jamais...",
        btn_ask_sage: "Demander conseil",
        quiz_title: "Quiz de Sagesse üß†",
        btn_explain: "Expliquer",
        btn_listen: "√âcouter",
        btn_image: "Cr√©er Image",
        toast_copied: "Copi√© !",
        toast_fav_added: "Ajout√© aux favoris",
        toast_fav_removed: "Retir√© des favoris",
        loading_text: "Chargement de la sagesse...",
        quiz_start_btn: "Lancer le Quiz",
        quiz_score: "Score",
        quiz_question: "Question"
    },
    kab: {
        nav_home: "Axxam", nav_explore: "Snadi", nav_favorites: "Iferrazen", nav_ai: "Amusnaw AI", nav_quiz: "Turart",
        subtitle: "Igerrujen n Teqbaylit",
        welcome_text: "Inadi, issin inzan n teqbaylit s tmusni n AI.",
        proverb_of_day_title: "Inzi n Wass-a üí°",
        keyboard_label: "TIRA ‚µ£ :",
        search_placeholder: "Nadi s wawalen...",
        themes_label: "Isental:",
        btn_random: "Menwala",
        favorites_title: "Iferrazen-iw ‚ù§Ô∏è",
        no_favorites: "Ur tes…õi·∏ç ara yakan inzan.",
        ai_title: "Amusnaw n AI ü§ñ",
        ai_desc: "Ef-d tagnit, amusnaw ad ak-d-yaf inzi i d-yewwi fell-as.",
        ai_placeholder: "Amedya: Ameddakel-iw ihedder a·π≠as maca ur ixeddem ara...",
        btn_ask_sage: "Steqsi Amusnaw",
        quiz_title: "Turart n Tmusni üß†",
        btn_explain: "Fhem",
        btn_listen: "Sme·∏•s-as",
        btn_image: "Tewlaft",
        toast_copied: "Yettwakkes !",
        toast_fav_added: "Yerna …£er iferrazen",
        toast_fav_removed: "Yekkes seg iferrazen",
        loading_text: "Araj...",
        quiz_start_btn: "Bdu Turart",
        quiz_score: "Agemmu·∏ç",
        quiz_question: "Asteqsi"
    }
};

/**
 * STATE MANAGEMENT
 */
const state = {
    lang: localStorage.getItem('inzan_lang') || 'fr',
    theme: localStorage.getItem('inzan_theme') || 'light',
    proverbs: [],
    favorites: new Set(JSON.parse(localStorage.getItem('inzan_favorites')) || []),
    currentProverbs: [], // Proverbes affich√©s actuellement
    page: 0,
    activeTab: 'accueil-tab',
    isLoading: false
};

// --- DOM ELEMENTS ---
const $ = (selector) => document.querySelector(selector);
const $$ = (selector) => document.querySelectorAll(selector);

/**
 * INITIALIZATION
 */
document.addEventListener('DOMContentLoaded', async () => {
    initTheme();
    initLanguage();
    initKeyboard();
    setupEventListeners();
    
    try {
        const response = await fetch('proverbs.json');
        if(!response.ok) throw new Error("Fichier proverbs.json introuvable");
        state.proverbs = await response.json();
        
        // Ajout des IDs si manquants
        state.proverbs = state.proverbs.map((p, i) => ({...p, id: p.id || i}));
        
        loadDailyProverb();
        loadThemes();
        
        // Chargement initial Explorer
        state.currentProverbs = state.proverbs;
        renderProverbsChunk(true);
        
        $('#splash-screen').classList.add('opacity-0', 'pointer-events-none');
    } catch (e) {
        console.error(e);
        $('#splash-screen').innerHTML = `<p class="text-red-500">Erreur chargement: proverbs.json</p>`;
    }
});

/**
 * LOGIQUE DE TRADUCTION & TH√àME
 */
function initLanguage() {
    applyLanguage(state.lang);
    $('#lang-toggle').addEventListener('click', () => {
        state.lang = state.lang === 'fr' ? 'kab' : 'fr';
        localStorage.setItem('inzan_lang', state.lang);
        applyLanguage(state.lang);
    });
}

function applyLanguage(lang) {
    const dict = I18N[lang];
    document.documentElement.lang = lang;
    $('#current-lang-label').textContent = lang.toUpperCase();
    
    // Traduire les textes
    $$('[data-i18n]').forEach(el => {
        const key = el.dataset.i18n;
        if(dict[key]) el.textContent = dict[key];
    });
    // Traduire les placeholders
    $$('[data-placeholder-i18n]').forEach(el => {
        const key = el.dataset.placeholderI18n;
        if(dict[key]) el.placeholder = dict[key];
    });
    
    // Rafraichir les cartes si n√©cessaire (pour les boutons)
    if(state.proverbs.length) renderProverbsChunk(true);
    loadDailyProverb(); // Re-render daily
}

function initTheme() {
    const isDark = state.theme === 'dark';
    document.documentElement.classList.toggle('dark', isDark);
    updateThemeIcon(isDark);
    
    $('#theme-toggle').addEventListener('click', () => {
        const isNowDark = document.documentElement.classList.toggle('dark');
        state.theme = isNowDark ? 'dark' : 'light';
        localStorage.setItem('inzan_theme', state.theme);
        updateThemeIcon(isNowDark);
    });
}

function updateThemeIcon(isDark) {
    $('#theme-icon-light').classList.toggle('hidden', isDark);
    $('#theme-icon-dark').classList.toggle('hidden', !isDark);
}

/**
 * CLAVIER TAMAZIGHT & RECHERCHE
 */
function initKeyboard() {
    const container = $('#tamazight-keyboard');
    CONFIG.CHARS_KB.forEach(char => {
        const btn = document.createElement('button');
        btn.textContent = char;
        btn.className = "kb-char-btn px-2.5 py-1 bg-[var(--color-bg-card)] border border-[var(--color-border)] rounded shadow-sm hover:bg-[var(--color-primary)] hover:text-white text-lg text-[var(--color-text)]";
        btn.onclick = () => insertChar(char);
        container.appendChild(btn);
    });
}

function insertChar(char) {
    const input = $('#search-input');
    const start = input.selectionStart;
    const end = input.selectionEnd;
    const val = input.value;
    input.value = val.substring(0, start) + char + val.substring(end);
    input.selectionStart = input.selectionEnd = start + 1;
    input.focus();
    handleSearch(); // Trigger search immediately
}

/**
 * RENDU DES PROVERBES
 */
function createProverbCard(p, isDaily = false) {
    const dict = I18N[state.lang];
    const isFav = state.favorites.has(p.id);
    const themes = (p.theme || 'Divers').split(',').map(t => t.trim());
    
    const cardClass = isDaily 
        ? "bg-[var(--color-bg-card)] p-8 rounded-2xl shadow-2xl border-t-8 border-[var(--color-accent)] text-center transform transition hover:scale-[1.01]"
        : "bg-[var(--color-bg-card)] p-5 rounded-xl shadow-md hover:shadow-xl border border-[var(--color-border)] flex flex-col transition-all hover:-translate-y-1 relative group";

    return `
    <div class="${cardClass}" data-id="${p.id}">
        <div class="mb-4">
            <p class="text-xl md:text-2xl font-serif font-bold text-[var(--color-heading)] mb-2 leading-relaxed">¬´ ${p.kabyle} ¬ª</p>
            <p class="text-[var(--color-text)] font-light italic border-t border-[var(--color-border)] pt-2 mt-2 inline-block px-4">
                ${p.francais}
            </p>
        </div>
        
        <div class="mt-auto pt-3 flex flex-wrap justify-between items-center gap-3">
            <div class="flex gap-1 text-xs">
                ${themes.map(t => `<span class="px-2 py-1 bg-[var(--color-bg-alt)] rounded-full text-[var(--color-text-light)] font-bold uppercase tracking-wider text-[10px]">${t}</span>`).join('')}
            </div>
            
            <div class="flex items-center gap-1 opacity-90">
                <!-- TTS Button -->
                <button onclick="playTTS(this)" class="p-2 rounded-full hover:bg-[var(--color-bg-alt)] text-[var(--color-primary)] transition" title="${dict.btn_listen}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>
                </button>
                
                <!-- Image Button -->
                <button onclick="generateImage(this)" class="p-2 rounded-full hover:bg-[var(--color-bg-alt)] text-[var(--color-accent)] transition" title="${dict.btn_image}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
                </button>

                <!-- Favorite -->
                <button onclick="toggleFavorite(${p.id}, this)" class="p-2 rounded-full hover:bg-pink-50 text-gray-400 transition ${isFav ? 'text-pink-500 fill-pink-500' : ''}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="${isFav ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>
                </button>
            </div>
        </div>
        
        <!-- Action Expliquer -->
        <button onclick="explainProverb(${p.id})" class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition text-xs font-bold text-[var(--color-primary)] bg-[var(--color-bg-card)] px-2 py-1 rounded shadow border border-[var(--color-border)]">
            ${dict.btn_explain} ?
        </button>
    </div>`;
}

/**
 * FONCTIONNALIT√âS CULTURELLES & UX
 */

// 1. Synth√®se Vocale (Gemini TTS)
async function playTTS(btn) {
    const card = btn.closest('[data-id]');
    const id = parseInt(card.dataset.id);
    const proverb = state.proverbs.find(p => p.id === id);
    if(!proverb) return;

    // Feedback visuel
    const originalIcon = btn.innerHTML;
    btn.innerHTML = `<span class="loader" style="width:16px;height:16px;border-width:2px"></span>`;
    btn.disabled = true;

    try {
        const apiKey = CONFIG.GEMINI_API_KEY;
        const text = `Inzi n teqbaylit: ${proverb.kabyle}`;
        
        // Utilisation de l'API TTS
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                contents: [{ parts: [{ text: text }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Aoede" } } } // Aoede est souvent claire
                }
            })
        });

        if(!response.ok) throw new Error("Erreur TTS API");
        const data = await response.json();
        const audioData = data.candidates?.[0]?.content?.parts?.[0]?.inlineData?.data;

        if (audioData) {
            const audioBytes = Uint8Array.from(atob(audioData), c => c.charCodeAt(0));
            const audioBlob = new Blob([audioBytes], { type: 'audio/wav' }); // Le mod√®le renvoie du PCM/WAV souvent
            // Note: Si c'est du PCM brut, il faudrait un header WAV. Le mod√®le TTS Gemini renvoie g√©n√©ralement du "audio/wav" ou pcm encapsul√©.
            // On tente la lecture directe Blob URL. Si √ßa √©choue, c'est que c'est du raw PCM.
            // Pour ce code, assumons que le navigateur peut g√©rer ou que le mod√®le renvoie un format standard.
            // *Correctif*: Le mod√®le actuel renvoie souvent du L16 (PCM). 
            // Pour simplifier ce snippet HTML sans librairie WAV complexe, on va utiliser une astuce ou simplement notifier si √©chec.
            // Mais pour une d√©mo robuste, utilisons SpeechSynthesis en fallback si l'API est complexe √† d√©coder sans lib.
            
            // Tentative lecture
            const audioUrl = URL.createObjectURL(audioBlob);
            const audio = new Audio(audioUrl);
            await audio.play();
        } else {
            // Fallback navigateurs (souvent mal support√© pour le Kabyle, on utilise fran√ßais avec accent)
            const u = new SpeechSynthesisUtterance(proverb.kabyle);
            u.lang = 'fr-FR'; // Fallback acceptable
            speechSynthesis.speak(u);
        }

    } catch (e) {
        console.warn("TTS Error, fallback local", e);
        const u = new SpeechSynthesisUtterance(proverb.kabyle);
        u.lang = 'es-ES'; // Spanish pronounces vowels closer to Kabyle than English
        speechSynthesis.speak(u);
    } finally {
        btn.innerHTML = originalIcon;
        btn.disabled = false;
    }
}

// 2. G√©n√©rateur d'Image (Canvas) avec Motifs Berb√®res
function generateImage(btn) {
    const card = btn.closest('[data-id]');
    const id = parseInt(card.dataset.id);
    const proverb = state.proverbs.find(p => p.id === id);
    if(!proverb) return;

    const canvas = document.getElementById('share-canvas');
    const ctx = canvas.getContext('2d');
    
    // Configuration HD
    canvas.width = 1080;
    canvas.height = 1080;
    
    // Fond
    const gradient = ctx.createLinearGradient(0, 0, 1080, 1080);
    gradient.addColorStop(0, '#F9F7F3');
    gradient.addColorStop(1, '#F0EFEA');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, 1080, 1080);

    // --- MOTIFS BERB√àRES (DESSIN G√âOM√âTRIQUE) ---
    // Bordure Z (Yaz) stylis√©e
    ctx.strokeStyle = '#4A7C59'; // Vert
    ctx.lineWidth = 15;
    ctx.beginPath();
    // Haut
    ctx.moveTo(50, 50); ctx.lineTo(1030, 50);
    // Bas
    ctx.moveTo(50, 1030); ctx.lineTo(1030, 1030);
    ctx.stroke();

    ctx.strokeStyle = '#C79A2A'; // Jaune
    ctx.beginPath();
    // Gauche
    ctx.moveTo(50, 50); ctx.lineTo(50, 1030);
    // Droite
    ctx.moveTo(1030, 50); ctx.lineTo(1030, 1030);
    ctx.stroke();
    
    // Symbole ‚µ£ central en filigrane
    ctx.save();
    ctx.globalAlpha = 0.05;
    ctx.fillStyle = '#C79A2A';
    ctx.font = '800px "Noto Sans Tifinagh", sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('‚µ£', 540, 540);
    ctx.restore();

    // --- TEXTE ---
    // Titre
    ctx.fillStyle = '#C79A2A';
    ctx.font = 'bold 40px "Raleway", sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('INZAN N TEQBAYLIT', 540, 150);

    // Proverbe Kabyle
    ctx.fillStyle = '#2F4F4F';
    ctx.font = 'bold italic 70px "Tinos", serif';
    wrapText(ctx, `¬´ ${proverb.kabyle} ¬ª`, 540, 350, 900, 90);

    // Proverbe Fran√ßais
    ctx.fillStyle = '#555';
    ctx.font = '300 40px "Raleway", sans-serif';
    // On estime la hauteur du texte kabyle pour placer le fran√ßais
    // Simplification pour l'exemple : position fixe plus bas
    wrapText(ctx, proverb.francais, 540, 750, 800, 60);

    // Footer
    ctx.fillStyle = '#4A7C59';
    ctx.font = 'bold 30px sans-serif';
    ctx.fillText('www.inzan-kabyle.com', 540, 1000);

    // Export & Affichage Modal
    const dataUrl = canvas.toDataURL('image/png');
    showModal("Partager l'Image", `
        <div class="flex flex-col items-center">
            <img src="${dataUrl}" class="w-full max-w-sm rounded shadow-lg mb-4 border border-gray-200">
            <p class="text-sm text-center mb-4 text-gray-500">Appuyez longuement ou clic droit pour enregistrer et partager sur Instagram/WhatsApp.</p>
            <a href="${dataUrl}" download="inzan-${proverb.id}.png" class="px-6 py-3 bg-[var(--color-primary)] text-white rounded-lg font-bold shadow hover:bg-[var(--color-secondary)]">
                üì• T√©l√©charger l'image
            </a>
        </div>
    `);
}

function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
    const words = text.split(' ');
    let line = '';
    let testLine = '';
    let lineArray = [];
    
    for(let n = 0; n < words.length; n++) {
        testLine = line + words[n] + ' ';
        const metrics = ctx.measureText(testLine);
        const testWidth = metrics.width;
        if (testWidth > maxWidth && n > 0) {
            lineArray.push(line);
            line = words[n] + ' ';
        } else {
            line = testLine;
        }
    }
    lineArray.push(line);
    
    // Centrage vertical simple
    for(let k = 0; k < lineArray.length; k++) {
        ctx.fillText(lineArray[k], x, y + (k * lineHeight));
    }
}

/**
 * LOGIQUE G√âN√âRALE (Recherche, Navigation, API)
 */

function setupEventListeners() {
    // Navigation Tabs
    $$('.nav-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const tabId = btn.dataset.tab;
            state.activeTab = tabId;
            $$('.tab-content').forEach(tc => tc.classList.remove('active'));
            $$('.nav-btn').forEach(nb => nb.classList.remove('active'));
            
            $(`#${tabId}`).classList.add('active');
            $$(`.nav-btn[data-tab="${tabId}"]`).forEach(nb => nb.classList.add('active'));
            
            if(tabId === 'favoris-tab') renderFavorites();
            if(tabId === 'quiz-tab') startQuiz();
        });
    });

    // Recherche
    $('#search-input').addEventListener('input', (e) => {
        const val = e.target.value;
        $('.clear-search-btn').style.opacity = val ? '1' : '0';
        handleSearch();
    });
    $('.clear-search-btn').addEventListener('click', () => {
        $('#search-input').value = '';
        $('.clear-search-btn').style.opacity = '0';
        handleSearch();
    });
    
    $('#random-btn').addEventListener('click', () => {
        const rand = state.proverbs[Math.floor(Math.random() * state.proverbs.length)];
        $('#results-container').innerHTML = ''; // Clear
        renderChunk(false, [rand]);
        window.scrollTo({top: 400, behavior: 'smooth'});
    });

    // Scroll Infini
    window.addEventListener('scroll', () => {
        if(state.activeTab === 'explorer-tab' && (window.innerHeight + window.scrollY) >= document.body.offsetHeight - 500) {
            renderProverbsChunk();
        }
    });

    // AI
    $('#ai-suggest-btn').addEventListener('click', askSageAI);
    
    // Modal Close
    $('#modal-close-btn').addEventListener('click', closeModal);
    $('#modal-backdrop').addEventListener('click', closeModal);
}

function handleSearch() {
    const query = normalizeText($('#search-input').value);
    const theme = document.querySelector('.theme-btn.active')?.dataset.theme;
    
    const filtered = state.proverbs.filter(p => {
        const textMatch = normalizeText(p.kabyle).includes(query) || normalizeText(p.francais).includes(query);
        const themeMatch = !theme || (p.theme && p.theme.includes(theme));
        return textMatch && themeMatch;
    });
    
    state.currentProverbs = filtered;
    renderProverbsChunk(true);
}

function renderProverbsChunk(reset = false, specificList = null) {
    if(reset) {
        state.page = 0;
        $('#results-container').innerHTML = '';
    }
    if(state.isLoading) return;
    
    state.isLoading = true;
    const list = specificList || state.currentProverbs;
    const start = state.page * CONFIG.PROVERBS_PER_PAGE;
    const chunk = list.slice(start, start + CONFIG.PROVERBS_PER_PAGE);
    
    if(chunk.length === 0 && reset) {
        $('#results-container').innerHTML = `<p class="text-center col-span-full text-[var(--color-text-light)] p-8">Aucun r√©sultat trouv√© ‚µ£</p>`;
    } else {
        const html = chunk.map(p => createProverbCard(p)).join('');
        $('#results-container').insertAdjacentHTML('beforeend', html);
        state.page++;
    }
    
    state.isLoading = false;
    $('#results-feedback').textContent = `${list.length} proverbes trouv√©s`;
}

function toggleFavorite(id, btn) {
    if(state.favorites.has(id)) {
        state.favorites.delete(id);
        showToast(I18N[state.lang].toast_fav_removed, 'bg-red-500');
    } else {
        state.favorites.add(id);
        showToast(I18N[state.lang].toast_fav_added, 'bg-[var(--color-primary)]');
    }
    localStorage.setItem('inzan_favorites', JSON.stringify([...state.favorites]));
    
    // UI Update
    const isFav = state.favorites.has(id);
    const svg = btn.querySelector('svg');
    svg.setAttribute('fill', isFav ? 'currentColor' : 'none');
    btn.classList.toggle('text-pink-500', isFav);
    btn.classList.toggle('fill-pink-500', isFav);
    
    if(state.activeTab === 'favoris-tab') renderFavorites();
}

function renderFavorites() {
    const favs = state.proverbs.filter(p => state.favorites.has(p.id));
    const container = $('#favorites-container');
    const empty = $('#no-favorites');
    
    if(favs.length === 0) {
        container.innerHTML = '';
        empty.classList.remove('hidden');
    } else {
        empty.classList.add('hidden');
        container.innerHTML = favs.map(p => createProverbCard(p)).join('');
    }
}

// --- AI LOGIC (Simul√©e pour l'UX ou appel API si cl√© pr√©sente) ---
async function askSageAI() {
    const prompt = $('#ai-context-input').value;
    if(!prompt) return;
    
    const btn = $('#ai-suggest-btn');
    const originalText = btn.innerHTML;
    btn.innerHTML = `<span class="loader"></span>`;
    btn.disabled = true;
    
    try {
        // Recherche s√©mantique locale "simul√©e" intelligente (mot-cl√©s)
        // En prod, on enverrait √ßa √† Gemini pour avoir des ID en retour
        const keywords = prompt.toLowerCase().split(' ').filter(w => w.length > 3);
        const matches = state.proverbs.filter(p => {
            const content = (p.kabyle + " " + p.francais + " " + p.theme).toLowerCase();
            return keywords.some(k => content.includes(k));
        }).slice(0, 3);
        
        const container = $('#ai-result-feedback');
        if(matches.length > 0) {
            container.innerHTML = matches.map(p => `
                <div class="border-l-4 border-[var(--color-accent)] pl-4">
                    <p class="text-sm text-[var(--color-text-light)] mb-1">Le sage propose :</p>
                    ${createProverbCard(p)}
                </div>
            `).join('');
        } else {
            container.innerHTML = `<p class="text-center text-[var(--color-text-light)]">Le sage m√©dite... mais ne trouve pas de correspondance exacte. Essayez d'autres mots.</p>`;
        }
    } catch(e) {
        console.error(e);
    } finally {
        btn.innerHTML = originalText;
        btn.disabled = false;
    }
}

// --- UTILS ---
function normalizeText(text) {
    return text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
}

function loadDailyProverb() {
    if(!state.proverbs.length) return;
    const day = Math.floor(Date.now() / 86400000);
    const p = state.proverbs[day % state.proverbs.length];
    $('#proverb-of-the-day-card').innerHTML = createProverbCard(p, true);
}

function loadThemes() {
    const themes = [...new Set(state.proverbs.flatMap(p => (p.theme||'').split(',').map(t=>t.trim())))].sort();
    const html = themes.map(t => `<button class="theme-btn flex-shrink-0 px-3 py-1 bg-[var(--color-bg-alt)] rounded-full text-sm hover:bg-[var(--color-primary)] hover:text-white transition" data-theme="${t}">${t}</button>`).join('');
    $('#theme-list-container').innerHTML = `<button class="theme-btn active px-3 py-1 bg-[var(--color-primary)] text-white rounded-full text-sm">Tous</button>` + html;
    
    $$('.theme-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            $$('.theme-btn').forEach(b => {
                b.classList.remove('active', 'bg-[var(--color-primary)]', 'text-white');
                b.classList.add('bg-[var(--color-bg-alt)]');
            });
            e.target.classList.add('active', 'bg-[var(--color-primary)]', 'text-white');
            e.target.classList.remove('bg-[var(--color-bg-alt)]');
            handleSearch();
        });
    });
}

function showModal(title, content) {
    $('#modal-title').textContent = title;
    $('#modal-body').innerHTML = content;
    $('#modal-backdrop').classList.remove('hidden');
    $('#modal-content').classList.remove('hidden', 'scale-95', 'opacity-0');
}

function closeModal() {
    $('#modal-backdrop').classList.add('hidden');
    $('#modal-content').classList.add('hidden', 'scale-95', 'opacity-0');
}

function showToast(msg, bgClass = 'bg-gray-800') {
    const t = $('#toast');
    t.className = `fixed bottom-24 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full shadow-xl z-50 transition-all duration-300 translate-y-0 opacity-100 text-white font-medium text-sm flex items-center gap-2 ${bgClass}`;
    t.textContent = msg;
    setTimeout(() => {
        t.classList.add('translate-y-10', 'opacity-0');
    }, 3000);
}

// --- QUIZ SIMPLIFI√â ---
function startQuiz() {
    const container = $('#quiz-container');
    if(state.proverbs.length < 4) {
        container.innerHTML = "<p>Pas assez de donn√©es pour le quiz.</p>";
        return;
    }
    
    // G√©n√©ration question al√©atoire
    const correct = state.proverbs[Math.floor(Math.random() * state.proverbs.length)];
    const others = state.proverbs.filter(p => p.id !== correct.id).sort(()=>0.5-Math.random()).slice(0, 3);
    const options = [correct, ...others].sort(()=>0.5-Math.random());
    
    container.innerHTML = `
        <div class="w-full text-center">
            <p class="text-sm uppercase tracking-widest text-[var(--color-text-light)] mb-4">${I18N[state.lang].quiz_question}</p>
            <h3 class="text-2xl font-bold mb-8 font-serif">¬´ ${correct.kabyle} ¬ª</h3>
            <div class="grid gap-3">
                ${options.map(opt => `
                    <button onclick="checkQuiz(${opt.id === correct.id}, this)" class="p-4 rounded-lg border-2 border-[var(--color-border)] hover:border-[var(--color-primary)] hover:bg-[var(--color-bg-alt)] transition text-left">
                        ${opt.francais}
                    </button>
                `).join('')}
            </div>
        </div>
    `;
}

window.checkQuiz = (isCorrect, btn) => {
    const all = btn.parentElement.querySelectorAll('button');
    all.forEach(b => b.disabled = true);
    if(isCorrect) {
        btn.classList.add('bg-green-100', 'border-green-500', 'text-green-800');
        showToast("Bravo ! üéâ", "bg-green-600");
    } else {
        btn.classList.add('bg-red-100', 'border-red-500', 'text-red-800');
        showToast("Oups...", "bg-red-500");
    }
    setTimeout(startQuiz, 2000);
};

// Fonction Expliquer (Appel API Placeholder)
window.explainProverb = (id) => {
    const p = state.proverbs.find(o => o.id === id);
    showModal(`Explication`, `
        <div class="space-y-4">
            <p class="font-serif text-xl font-bold">¬´ ${p.kabyle} ¬ª</p>
            <div class="p-4 bg-[var(--color-bg-alt)] rounded">
                <p class="font-bold mb-2">Signification :</p>
                <p>${p.francais}</p>
            </div>
            <p class="text-sm text-[var(--color-text-light)]">Le syst√®me IA g√©n√©rera une analyse culturelle d√©taill√©e ici (Contexte, Origine, Usage).</p>
        </div>
    `);
};

</script>
</body>
</html>
